{
    "collab_server" : "",
    "contents" : "---\ntitle: \"Public Health and Economic Impact of Hydro-Meteorological Events (Storms)\"\nauthor: \"John James\"\ndate: \"March 6, 2016\"\noutput: \n  html_document: \n    fig_caption: yes\n    fig_height: 12\n    keep_md: yes\n    toc: yes\n---\n\n```{r setup, include=FALSE, echo=FALSE}\nknitr::opts_chunk$set(echo = TRUE)\nlibrary(knitr)\nread_chunk(\"master.R\")\nread_chunk(\"load.R\")\nread_chunk(\"review.R\")\nread_chunk(\"process.R\")\nread_chunk(\"analyze.R\")\nread_chunk(\"present.R\")\nknitr::opts_knit$set(root.dir = 'C:/Users/John/Documents/GitHub/RepResearch_Course_Project_2')\nknitr::opts_chunk$set(fig.width=12, fig.height=16, fig.path = \"../figures/\", echo=TRUE, warning=FALSE)\n```\n\n## Synopsis\n\n## Introduction\nStorms and other severe weather events can cause both public health and economic problems for communities and municipalities. Many severe events can result in fatalities, injuries, and property damage, and preventing such outcomes to the extent possible is a key concern.\n\nThe purpose of this project was to explore and analyze the U.S. National Oceanic and Atmospheric Administration's (NOAA) storm database to determine which types of hydro-meteorological events posed the greatest public health and economic cost.\n\n## Research Question\nThe report seeks to address the following questions:\n\n1. Across the United States, which types of events are most harmful with respect to population health?\n2. Across the United States, which types of events have the greatest economic consequences?\n\n## Raw Data \nThis report analyzed the NOAA Storm Events Database which documents the occurrence of storms and other significant weather phenomena having sufficient intensity to cause loss of life, injuries, significant property damage, and/or disruption to commerce. The database currently contains data from January 1950 to November 2015, as entered by NOAA's National Weather Service (NWS), capturing fatalities, property damage, and crop damage for some 48 designated event types.\n\n## Data Processing\n### Environment Setup\nThe following code configures the environment for the analysis.  Filenames are designated, the directory structure is established, and the requisite files and libraries are sourced.  \n\n```{r echo = TRUE, message = F, eval = T, tidy=TRUE, tidy.opts=list(comment=TRUE)}\n<<environment>>\n```\n\n### Load Data\nThis function downloads a zipped file from the web and stores it in the designated directory.  The function checks of the raw data directory exists, and creates it if it doesn't.  Next, the file is downloaded if the file doesn't exist, or the the file wasn't downloaded on the current day. Finally, we read the file into a data frame and return it to the master script.\n\n  * Args:\n\n    + url - the url for website from which the file will be downloaded\n    + dir - the redirectory to which the file will be stored\n    + zip - the name of the zip file\n    + CSV - the name of the csv file\n    + df  - the name of thd data frame that contains the data\n\n  * Response: This function will load the storm data file into a data frame and return it to the calling script\n```{r echo = TRUE, message = F, eval = T, tidy=TRUE, tidy.opts=list(comment=FALSE)}\n<<loadDataFunc>>\n```\n\nThe function above is called here if \"Load\" (from environment variables) is set to TRUE\n```{r echo = TRUE, message = F, eval = T, tidy=TRUE, tidy.opts=list(comment=FALSE)}\n<<loadDataCall>>\n```\n\n### Data Review\nThe following code provides the dimensions of the dataset, the number of unique event types, and the number of rows with zero values for each of the variables being analyzed.\n```{r echo = TRUE, message = F, eval = T, tidy=TRUE, tidy.opts=list(comment=FALSE)}\n<<reviewDataFunc>>\n```\n\n```{r echo = TRUE, message = F, eval = T, tidy=TRUE, tidy.opts=list(comment=FALSE)}\n<<reviewData>>\n```\n\nThere were **`r observations`** observations in the original data file, each having **`r variables`** variables.  The data set contained **`r numEventTypes`** unique event types and **`r zeroRows`** rows have zero values for each of the variables being measured.\n\n\n### Data Transformations\nBefore analyzing the data, several data transformations were undertaken. \n\n#### Remove Zero Rows\nThis statement removes rows in which the value of each of the measurement variables is zero.\n\n```{r echo = TRUE, message = F, eval = T, tidy=TRUE, tidy.opts=list(comment=FALSE)}\n<<removeZeroRows>>\n```\n\n#### Extract Variables\nThe variables of interest for this analysis were:\n\n* EVTYPE - The type of event.  The data contained 985 factor levels.\n* BGN_DATE - The date upon which the weather event occurred\n* FATALITIES - The number of fatalities directly caused by the weather event\n* INJURIES - The number of persons injured as a direct consequence of the weather event.\n* PROPDMG - The estimated amount of property damage indicated in dollar amounts adjusted by the PROPDMGEXP factor\n* PROPDMGEXP - This factor indicates multiplicative factor to apply to the PROPDMG number.  For instance, a value of \"K\" indicates that the number in PROPDMG should be multiplied by 1000.  \n* CROPDMG - The estimated amount of crop damage indicated in dollar amounts adjusted by the PROPDMGEXP factor\n* CROPDMGEXP - This factor indicates multiplicative factor to apply to the CROPDMG number.  For instance, a value of \"2\" indicates that the number in PROPDMG should be multiplied by 100.  \n\nThe following code extracts the variables of interest for this analysis:\n\n```{r echo = TRUE, message = F, eval = T, tidy=TRUE, tidy.opts=list(comment=FALSE)}\n<<extractVariables>>\n```\n\n#### Event Type\nThere were 48 designated event types; however, there were 985 different factor levels for EVTYPE.  The following function and the associated call recodes the EVTYPE variable to one of the 48 designated values.  The designated event types are described in the NOAA Storm Data Directive NWSPD 10-16 which is available on the NOAA website at https://d396qusza40orc.cloudfront.net/repdata%2Fpeer2_doc%2Fpd01016005curr.pdf. \n\n```{r echo = TRUE, message = F, eval = T, tidy=TRUE, tidy.opts=list(comment=FALSE)}\n<<processEventTypeFunc>>\n```\n\n```{r echo = TRUE, message = F, eval = T, tidy=TRUE, tidy.opts=list(comment=FALSE)}\n<<processEventTypeCall>>\n```\n\n#### Property & Crop Damage\nThe following function along with its function call, converts the property and crop damage estimates to dollar values. PROPDMGEXP and CROPDMGEXP contain the base ten exponent by which the property and crop damage estimates must be multiplied to reflect dollar terms.  Lastly, two new variables are created: one to hold the sum of fatalities & injuries and the second contains total damage which is the sum of property and crop damage estimates.\n\n```{r echo = TRUE, message = F, eval = T, tidy=TRUE, tidy.opts=list(comment=FALSE)}\n<<processDamageFunc>>\n```\n\n```{r echo = TRUE, message = F, eval = T, tidy=TRUE, tidy.opts=list(comment=FALSE)}\n<<processDamageCall>>\n```\n\n#### Year\nThe following function, along with its function call, creates a new categorical variable that is equal to the year in which the event occurred.  This factor will be used to analyze health and economic impacts over time.\n\n\n```{r echo = TRUE, message = F, eval = T, tidy=TRUE, tidy.opts=list(comment=FALSE)}\n<<processYearFunc>>\n```\n\n```{r echo = TRUE, message = F, eval = T, tidy=TRUE, tidy.opts=list(comment=FALSE)}\n<<processYearCall>>\n```\n\n### Data Analysis\nHealth and economic impacts were evaluated from two perspectives. First, the health and economic effects were examined over the entire data set, by event type.  Next, time series plots were rendered to illuminate any trends over time. Finally, we observe impacts over a subset of the most recent data based upon any trends observed.\n\n#### Top 5 Event Types\nThe following six functions calculate the top 5 event types, in terms of health and economic impact.\n```{r echo = TRUE, message = F, eval = T, tidy=TRUE, tidy.opts=list(comment=FALSE)}\n<<analysisFunc>>\n```\n\nThe above functions are called to calculated top 5 event types in terms of health and economic impact, across all data.\n```{r echo = TRUE, message = F, eval = T, tidy=TRUE, tidy.opts=list(comment=FALSE)}\n<<top5AllData>>\n```\n\nNext, we calculate the time series data that will be used to reveal trends over time.\n```{r echo = TRUE, message = F, eval = T, tidy=TRUE, tidy.opts=list(comment=FALSE)}\n<<timeSeriesData>>\n```\n\nThen, we select storm data published since 1990.\n```{r echo = TRUE, message = F, eval = T, tidy=TRUE, tidy.opts=list(comment=FALSE)}\n<<extract1990Data>>\n```\n\nLastly, we use the \"top 5\" functions to calculate top 5 event types, in terms of health and economic impact, for data published since 1990.\n```{r echo = TRUE, message = F, eval = T, tidy=TRUE, tidy.opts=list(comment=FALSE)}\n<<top51990>>\n```\n\n\n### Data Presentation\nThe following section contains the functions and calls required to present the data graphically.  \n\n#### Bar Plot Functions\nThe following functions are used to render bar plots of the top 5 event types, in terms of health and economic impact.\n```{r echo = TRUE, message = F, eval = T, tidy=TRUE, tidy.opts=list(comment=FALSE)}\n<<barPlotFuncs>>\n```\n\n#### Time Series Plot Functions\nThe following functions are used to render line charts of the top 5 event types, in terms of health and economic impact.\n```{r echo = TRUE, message = F, eval = T, tidy=TRUE, tidy.opts=list(comment=FALSE)}\n<<trendLineFuncs>>\n```\n\n## Results\nThe following code renders a group of bar plots, showing the health and economic impacts for storm data from 1950.\n\n```{r echo = TRUE, message = F, eval = T, tidy=TRUE, tidy.opts=list(comment=FALSE)}\n<<top5BarPlotsAll>>\n```\n\n### Health & Economic Impacts, 1950 to Present\n\n**Health Impacts**\n\nBased upon available data since 1950, it would appear that **`r top5Health[1,1]`** have the greatest public health impact.  Referring to the center-left red bar chart, total healthcare incidents (fatalities + injuries) for **`r top5Health[1,1]`** topped **`r paste(format(top5Health[1,2],big.mark=\",\"), sep=\"\")`** fatalities and injuries since 1950 - **`r round(100* top5Health[1,2]/(top5Health[2,2] + top5Health[3,2] + top5Health[4,2] + top5Health[5,2]), digits=0)`** percent of the next 4 top events, combined.\n\n**Economic Impacts**\n\nSimilarly, the red bar chart in the lower right corner shows **`r top5TotalDmg[1,1]`** as having the greatest overall economic impact.  Generating over **`r paste(\"$\",format(round(top5TotalDmg[1,2], digits=0),big.mark=\",\"),sep=\"\")`** of estimated economic cost, **`r top5TotalDmg[1,1]`** create **`r (round(100*top5TotalDmg[1,2]/top5TotalDmg[2,2]))`** percent of the damage created by **`r top5TotalDmg[2,1]`**.\n\n### Time Series of Health & Economic Impacts\nThe following time series plots depict the health and economic impacts over time for the top 5 events, as reported by NOAA.  \n```{r echo = TRUE, message = F, eval = T, tidy=TRUE, tidy.opts=list(comment=FALSE)}\n<<trendLine>>\n```\nThe data evinces several interesting inferences.\n1.  Data for the event types having the highest impact on health and economics, don't emerge until approximately 1990.\n2.  Starting in 1990's, extreme heat emerges as a leading cause of fatalities.\n3.  Winter storms seem to generate higher economic costs from 1990 forward.\n\nGiven the stratification of the data over time, one might conclude that a closer look at the storm data from 1990 forward, might provide a more accurate assessment of the health and economic effects vis-a-vis storm events. \n\nThe following chart illucidates the health and economic impacts since 1990.  \n```{r echo = TRUE, message = F, eval = T, tidy=TRUE, tidy.opts=list(comment=FALSE)}\n<<top5BarPlots1990>>\n```\n\n### Health & Economic Impacts, 1990 to Present\n\n**Health Impacts**\n\nAs with the data from 1950, **`r top5Health1990[1,1]`** seem to have the greatest overall impact on public health; however, **`r top5Fatalities1990[2,1]`** emerges as the leading cause of storm related fatalities with **`r round(100* top5Fatalities1990[1,2]/top5Fatalities1990[2,2])`** percent of the fatalities reported for **`r top5Fatalities1990[2,1]`**\n\n**Economic Impacts**\n\nThe data from 1990 forward presents a different economic impact assessment.  Here, **`r top5TotalDmg1990[1,1]`** emerge as the leading cause of storm related economic damage.  With an estimated **`r paste(\"$\",format(round(top5TotalDmg1990[1,2], digits=0),big.mark=\",\"),sep=\"\")`** in storm related economic costs, **`r top5TotalDmg1990[1,1]`** account for **`r (round(100*top5TotalDmg1990[1,2]/top5TotalDmg1990[2,2]))-100`** percent greater damage than that created by **`r top5TotalDmg1990[2,1]`**.   \n\n## Conclusion\n\nStorms and other severe weather events exact public health and economic costs and the prevention or control of such costs, is a key priority.  The purpose of this study was to ascertain which types of weather events are most harmful to public health, and which events caused the greatest economic consequences.  An exploration and analysis of the NOAA Storm Database was conducted to determine which storm weather events generated the highest public health and economic costs.  Given the stratification of the data, observations of events occurring from 1990 to 2011 formed the basis of the analysis and the conclusions.  \n\nFrom a public health perspective, **`r top5Health1990[1,1]`** generate the highest number of health incidents; whereas, **`r top5Fatalities1990[1,1]`** is responsible for the greatest number of weather & storm related fatalities.  From an economic standpoint, **`r top5TotalDmg1990[1,1]`** emerges as the most costly weather events.\n\nThe purpose of this study of which is  can cause both public health and economic problems for communities and municipalities. Many severe events can result in fatalities, injuries, and property damage, and preventing such outcomes to the extent possible is a key concern.\n\n\n\n\n## References\n(NOAA), U. N. (2016, March 8). NOAA Storm Database. Retrieved from NOAA National Centers for Environmental Information: https://www.ncdc.noaa.gov/stormevents/\n\n",
    "created" : 1458293327304.000,
    "dirty" : false,
    "encoding" : "UTF-8",
    "folds" : "",
    "hash" : "3176144872",
    "id" : "CE8420E1",
    "lastKnownWriteTime" : 1458311038,
    "last_content_update" : 1458311038187,
    "path" : "~/GitHub/RepResearch_Course_Project_2/Code/NOAA_Storm.Rmd",
    "project_path" : "Code/NOAA_Storm.Rmd",
    "properties" : {
    },
    "relative_order" : 1,
    "source_on_save" : false,
    "source_window" : "",
    "type" : "r_markdown"
}